var GameRunnerInstance,EndGate;(function(n){(function(n){var t=function(){function n(){this._type="GameTime",this.Now=new Date,this._start=this.Now.getTime()}return n.prototype.Update=function(){var n=new Date,t=n.getTime();this.Elapsed=t-this.Now.getTime(),this.Total=t-this._start,this.Now=n},n}();n.GameTime=t})(n.Core||(n.Core={}));var t=n.Core})(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(t,i){this._type="LooperCallback",this.Fps=t,this.Callback=i,this.TimeoutID=0,this.ID=n._ids++}return n._ids=0,n}();n.LooperCallback=t})(n.Utilities||(n.Utilities={}));var t=n.Utilities})(n.Core||(n.Core={}));var t=n.Core}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){this._type="Looper",this._running=!1,this._callbacks=[]}return n.prototype.AddCallback=function(n){this._callbacks.push(n),this._running&&this.Loop(n)},n.prototype.RemoveCallback=function(n){for(var i=!1,t=0;t<this._callbacks.length;t++)if(this._callbacks[t].ID===n.ID){i=!0;break}if(i)window.clearTimeout(n.TimeoutID),this._callbacks.splice(t,1);else throw new Error("Callback does not exist.");},n.prototype.Start=function(){this._running=!0,this.Run()},n.prototype.Run=function(){for(var n=0;n<this._callbacks.length;n++)this.Loop(this._callbacks[n])},n.prototype.Loop=function(n){var t=this,i=1e3/n.Fps;n.Callback(),n.TimeoutID=window.setTimeout(function(){t.Loop(n)},i)},n.prototype.Dispose=function(){for(var n=this._callbacks.length-1;n>=0;n--)this.RemoveCallback(this._callbacks[n]);this._callbacks=[],this._running=!1},n}();n.Looper=t})(n.Utilities||(n.Utilities={}));var t=n.Utilities})(n.Core||(n.Core={}));var t=n.Core}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function n(n){this._defaultUpdateRate=40,this._updateRateSetter=n,this.UpdateRate(this._defaultUpdateRate)}return n.prototype.UpdateRate=function(n){if(typeof n!="undefined")this._updateRate=n,this._updateRateSetter(this._updateRate);else return this._updateRate},n}();n.GameConfiguration=t})(n.Core||(n.Core={}));var t=n.Core}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(){this._type="Game",this._gameTime=new n.GameTime,this.ID=t._gameIds++,this.Configuration=new n.GameConfiguration(GameRunnerInstance.Register(this))}return t._gameIds=0,t.prototype.PrepareUpdate=function(){this._gameTime.Update(),this.Update(this._gameTime)},t.prototype.Update=function(){},t.prototype.Dispose=function(){GameRunnerInstance.Unregister(this)},t}();n.Game=t})(n.Core||(n.Core={}));var t=n.Core}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(){this._type="GameRunner",this._callbacks={},this._gameLoop=null,this._callbackCount=0}return t.prototype.Register=function(n){var t=this.CreateAndCacheCallback(n);return this.TryLoopStart(),this._gameLoop.AddCallback(t),this.CreateUpdateRateSetter(t)},t.prototype.Unregister=function(n){var t;this._callbacks[n.ID]&&(t=this._callbacks[n.ID],this._gameLoop.RemoveCallback(t),delete this._callbacks[n.ID],this._callbackCount--,this.TryLoopStop())},t.prototype.TryLoopStart=function(){this._callbackCount===1&&(this._gameLoop=new n.Utilities.Looper,this._gameLoop.Start())},t.prototype.TryLoopStop=function(){this._callbackCount===0&&this._gameLoop!=null&&(this._gameLoop.Dispose(),this._gameLoop=null)},t.prototype.CreateAndCacheCallback=function(t){var i=new n.Utilities.LooperCallback(0,function(){t.PrepareUpdate()});return this._callbacks[t.ID]=i,this._callbackCount++,i},t.prototype.CreateUpdateRateSetter=function(n){return function(t){n.Fps=t}},t}();n.GameRunner=t})(n.Core||(n.Core={}));var t=n.Core}(EndGate||(EndGate={})),GameRunnerInstance=new EndGate.Core.GameRunner,Math.roundTo=function(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i},function(n){(function(n){(function(n){var t=function(){function n(n,t){this._type="Vector2d",this.X=n||0,this.Y=t||0}return n.Zero=function(){return new n(0,0)},n.One=function(){return new n(1,1)},n.prototype.ProjectOnto=function(n){return n.Multiply(this.Dot(n)/n.Dot(n))},n.prototype.RotateAround=function(t,i,r){typeof r=="undefined"&&(r=2);var u=Math.cos(-i),f=Math.sin(-i);return new n(Math.roundTo(u*(this.X-t.X)-f*(this.Y-t.Y)+t.X,r),Math.roundTo(f*(this.X-t.X)+u*(this.Y-t.Y)+t.Y,r))},n.prototype.Apply=function(n){this.X=n(this.X),this.Y=n(this.Y)},n.prototype.Trigger=function(n){n(this.X),n(this.Y)},n.prototype.Normalized=function(){var t=this.Magnitude();return new n(this.X/t,this.Y/t)},n.prototype.Magnitude=function(){return Math.sqrt(this.X*this.X+this.Y*this.Y)},n.prototype.Length=function(){return this.Magnitude()},n.prototype.Dot=function(n){return n.X*this.X+n.Y*this.Y},n.prototype.Abs=function(){return new n(Math.abs(this.X),Math.abs(this.Y))},n.prototype.Sign=function(){return new n(this.X/Math.abs(this.X),this.Y/Math.abs(this.Y))},n.prototype.Distance=function(t){return new n(Math.abs(t.X-this.X),Math.abs(t.Y-this.Y))},n.prototype.Add=function(t){return t._type==="Vector2d"?new n(this.X+t.X,this.Y+t.Y):new n(this.X+t,this.Y+t)},n.prototype.Multiply=function(t){return t._type==="Vector2d"?new n(this.X*t.X,this.Y*t.Y):new n(this.X*t,this.Y*t)},n.prototype.Subtract=function(t){return t._type==="Vector2d"?new n(this.X-t.X,this.Y-t.Y):new n(this.X-t,this.Y-t)},n.prototype.SubtractFrom=function(t){return t._type==="Vector2d"?new n(t.X-this.X,t.Y-this.Y):new n(t-this.X,t-this.Y)},n.prototype.Divide=function(t){return t._type==="Vector2d"?new n(this.X/t.X,this.Y/t.Y):new n(this.X/t,this.Y/t)},n.prototype.DivideFrom=function(t){return t._type==="Vector2d"?new n(t.X/this.X,t.Y/this.Y):new n(t/this.X,t/this.Y)},n.prototype.Negate=function(){return new n(this.X*-1,this.Y*-1)},n.prototype.Equivalent=function(n){return this.X===n.X&&this.Y===n.Y},n.prototype.Clone=function(){return new n(this.X,this.Y)},n.prototype.toString=function(){return"("+this.X+", "+this.Y+")"},n}();n.Vector2d=t})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Core||(n.Core={}));var t=n.Core}(EndGate||(EndGate={})),Number.prototype._type="Number",String.prototype._type="String",Boolean.prototype._type="Boolean",Array.prototype._type="Array",Date.prototype._type="Date",Object.prototype._type="Object",Error.prototype._type="Error"