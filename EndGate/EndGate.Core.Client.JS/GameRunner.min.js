var EndGate,GameRunnerInstance;(function(n){(function(n){var t=function(){function t(){this._type="GameRunner",this._updateCallbacks={},this._drawCallbacks={},this._updateLoop=null,this._drawLoop=null,this._callbackCount=0}return t.prototype.Register=function(n){var t=this.CreateAndCacheUpdateCallback(n),i=this.CreateAndCacheDrawCallback(n);return this._callbackCount++,this.TryLoopStart(),this._updateLoop.AddCallback(t),this._drawLoop.AddCallback(i),this.CreateUpdateRateSetter(t)},t.prototype.Unregister=function(n){var t,i;this._updateCallbacks[n.ID]&&(t=this._updateCallbacks[n.ID],i=this._drawCallbacks[n.ID],this._updateLoop.RemoveCallback(t),this._drawLoop.RemoveCallback(i),delete this._updateCallbacks[n.ID],delete this._drawCallbacks[n.ID],this._callbackCount--,this.TryLoopStop())},t.prototype.TryLoopStart=function(){this._callbackCount===1&&(this._updateLoop=new n.Loopers.Looper,this._updateLoop.Start(),this._drawLoop=new n.Loopers.RepaintLooper,this._drawLoop.Start())},t.prototype.TryLoopStop=function(){this._callbackCount===0&&this._updateLoop!=null&&(this._updateLoop.Dispose(),this._updateLoop=null,this._drawLoop.Dispose(),this._drawLoop=null)},t.prototype.CreateAndCacheUpdateCallback=function(t){var i=new n.Loopers.TimedCallback(0,function(){t.PrepareUpdate()});return this._updateCallbacks[t.ID]=i,i},t.prototype.CreateAndCacheDrawCallback=function(t){var i=new n.Loopers.LooperCallback(function(){t.PrepareDraw()});return this._drawCallbacks[t.ID]=i,i},t.prototype.CreateUpdateRateSetter=function(n){return function(t){n.Fps=t}},t}();n.GameRunner=t})(n._||(n._={}));var t=n._})(EndGate||(EndGate={})),GameRunnerInstance=new EndGate._.GameRunner