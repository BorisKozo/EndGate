var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},EndGate;(function(n){(function(t){var i=function(i){function r(r,u,f,e){typeof f=="undefined"&&(f=!0),typeof e=="undefined"&&(e=!0);var o=this;i.call(this,r),this._moveSpeed=u,this._moving=new t._.LinearDirections,this.OnMove=new n.EventHandler,this._rotationUpdater=new n._.Utilities.NoopTripInvoker(function(){o.UpdateRotation()},f),this._velocityUpdater=e?this.UpdateVelocityWithMultiDirection:this.UpdateVelocityNoMultiDirection}return __extends(r,i),r.prototype.IsMovingInDirection=function(n){return this._moving[n]||!1},r.prototype.StartMoving=function(n){this.Move(n,!0)},r.prototype.StopMoving=function(n){this.Move(n,!1)},r.prototype.MoveSpeed=function(n){return typeof n!="undefined"&&(this._moveSpeed=n,this._velocityUpdater()),this._moveSpeed},r.prototype.Update=function(n){this._frozen||(this.Position=this.Position.Add(this.Velocity.Multiply(n.ElapsedSecond)),i.prototype.Update.call(this,n))},r.prototype.Move=function(n,t){if(typeof this._moving[n]!="undefined")this._moving[n]=t,this._velocityUpdater(),this._rotationUpdater.Invoke(),this.OnMove.Trigger({Direction:n,StartMoving:t});else throw new Error(n+" is an unknown direction.");},r.prototype.UpdateVelocityNoMultiDirection=function(){var t=n.Vector2d.Zero();t.X===0&&(this._moving.Up&&(t.Y-=this._moveSpeed),this._moving.Down&&(t.Y+=this._moveSpeed)),t.Y===0&&(this._moving.Left&&(t.X-=this._moveSpeed),this._moving.Right&&(t.X+=this._moveSpeed)),this.Velocity=t},r.prototype.UpdateVelocityWithMultiDirection=function(){var t=n.Vector2d.Zero();this._moving.Up&&(t.Y-=this._moveSpeed),this._moving.Down&&(t.Y+=this._moveSpeed),this._moving.Left&&(t.X-=this._moveSpeed),this._moving.Right&&(t.X+=this._moveSpeed),this.Velocity=t},r.prototype.UpdateRotation=function(){this.Velocity.IsZero()||(this.Rotation=Math.atan2(this.Velocity.Y,this.Velocity.X))},r}(t.Abstractions.MovementController);t.LinearMovementController=i})(n.MovementControllers||(n.MovementControllers={}));var t=n.MovementControllers})(EndGate||(EndGate={}))