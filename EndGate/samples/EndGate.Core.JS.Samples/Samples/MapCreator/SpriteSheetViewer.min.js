var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},SpriteSheetViewer=function(n){function t(t,i,r,u,f){n.call(this,t),this.SpriteSheetUrl=i,this._tileWidth=r,this._tileHeight=u,this._readyCallback=f,this.SelectedSources=[],this._cameraDragController=new CameraDragController(t,this.Scene.Camera,this.Input.Keyboard,this.Input.Mouse),this._cameraZoomController=new CameraZoomController(this.Scene.Camera,this.Input.Mouse),this.loadSpritesheet(i)}return __extends(t,n),t.prototype.loadSpritesheet=function(n){var t=this;this.ActiveSpriteSheet=new eg.Graphics.Assets.ImageSource(n),this.ActiveSpriteSheet.OnLoaded.Bind(function(){var r=!1,n,i;for(t.VisibleGrid?t.Scene.Camera.Position=new eg.Vector2d(t.Scene.DrawArea.width/2,t.Scene.DrawArea.height/2):r=!0,t.VisibleGrid=new eg.Graphics.Grid(t.Scene.DrawArea.width/2,t.Scene.DrawArea.height/2,Math.floor(t.ActiveSpriteSheet.ClipSize.Height/t._tileHeight),Math.floor(t.ActiveSpriteSheet.ClipSize.Width/t._tileWidth),t._tileWidth,t._tileHeight,!0),n=0;n<t.VisibleGrid.Rows();n++)for(i=0;i<t.VisibleGrid.Columns();i++)t.VisibleGrid.Fill(n,i,new eg.Graphics.Sprite2d(0,0,t.ActiveSpriteSheet.Extract(i*t._tileWidth,n*t._tileHeight,t._tileWidth,t._tileHeight)));r&&(t._tileHighlighter=new TileHighlighter(t.VisibleGrid),t._tileSelector=new TileSelector(t.VisibleGrid,t.Scene,t.Scene.Camera,t._cameraDragController,t.Input.Mouse,function(n){var r,i;for(t.SelectedSources=[],i=0;i<n.length;i++)r=t.VisibleGrid.Get(n[i].Row,n[i].Column),r&&t.SelectedSources.push(r.Image);t._tileHighlighter.HighlightTiles(n)},function(n){for(var r,u,i=0;i<n.length;i++)u=t.VisibleGrid.Get(n[i].Row,n[i].Column),u&&(r=t.SelectedSources.indexOf(u.Image),r>=0&&t.SelectedSources.splice(r,1));t._tileHighlighter.UnHighlightTiles(n)})),t.Scene.Add(t.VisibleGrid),t._readyCallback&&t._readyCallback()})},t}(eg.Game)