var PersistenceManager=function(){function n(n,t,i,r){this._getLayers=t,this._spriteSheetUrl=i,this._buildResourceMap=r;var u=this,f=$("#save"),e=$("#saveName"),o=$("#saveDialog"),s=this;f.click(function(){u.SaveMap(e.val()),o.html("Last saved at: "+(new Date).toTimeString())})}return n.prototype.SaveMap=function(n,t){var f,i,u,e,r;for(typeof t=="undefined"&&(t="mapBuilder"),f=[],i=this._getLayers(),u=0;u<i.length;u++)f.push({Layer:this._buildResourceMap(i[u].Layer),Name:i[u].Name});e={Rows:i[0].Layer.Rows(),Columns:i[0].Layer.Columns(),TileSize:i[0].Layer.TileSize(),SpriteSheetUrl:this._spriteSheetUrl,Layers:f},r=localStorage.getItem(t),r=r?JSON.parse(r):{},r[n]=e,localStorage.setItem(t,JSON.stringify(r))},n.GetSavedMaps=function(n){typeof n=="undefined"&&(n="mapBuilder");var t=localStorage.getItem(n);return JSON.parse(t)},n}()