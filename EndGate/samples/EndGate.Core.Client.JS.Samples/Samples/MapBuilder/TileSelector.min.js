var TileSelector=function(){function n(t,i,r,u,f,e,o){var a;this._grid=t,this._onSelect=e,this._onDeselect=o;var s=this,v=t.Children(),l,y=[],h,c=!1;for(this._groupSelector=new eg.Graphics.Rectangle(0,0,0,0,"rgb(100, 255, 0)"),this._groupSelector.Border(2,"green"),this._groupSelector.Opacity(.4),a=0;a<v.length;a++)l=v[a].GetDrawBounds(),l.Position=l.Position.Add(t.Position),y.push(l);f.OnDown.Bind(function(n){h=r.ToCameraRelative(n.Position)}),f.OnUp.Bind(function(){window.setTimeout(function(){c=!1},50),i.Remove(s._groupSelector)}),f.OnMove.Bind(function(t){var u;t.Position=r.ToCameraRelative(t.Position),f.IsDown&&!c&&t.Position.Distance(h).Magnitude()>=n._groupSelectAfter&&(c=!0,i.Add(s._groupSelector)),c&&(u=t.Position.Subtract(h),s._groupSelector.Size=new eg.Size2d(Math.abs(u.X),Math.abs(u.Y)),s._groupSelector.Position=t.Position.Subtract(s._groupSelector.Size.Multiply(.5).Multiply(u.Sign())))}),f.OnClick.Bind(function(n){var t=r.ToCameraRelative(n.Position),i=[],u;c?(u=s._groupSelector.GetDrawBounds(),i=s.GetSpaceSelection(s._grid.ConvertToRow(h.Y),s._grid.ConvertToColumn(h.X),s._grid.ConvertToRow(t.Y),s._grid.ConvertToColumn(t.X))):i.push(new GridEntry(s._grid.ConvertToRow(t.Y),s._grid.ConvertToColumn(t.X))),n.Button==="Left"?s._onSelect(i):n.Button==="Right"&&s._onDeselect(i)})}return n._groupSelectAfter=10,n.prototype.GetSpaceSelection=function(n,t,i,r){for(var e=[],o=i>=n?1:-1,s=r>=t?1:-1,f,u=n;u!==i+o;u+=o){if(u>this._grid.Rows())break;for(f=t;f!==r+s;f+=s){if(f>this._grid.Rows())break;e.push(new GridEntry(u,f))}}return e},n}()