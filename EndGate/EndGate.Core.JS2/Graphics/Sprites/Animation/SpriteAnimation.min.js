var EndGate;(function(n){(function(t){var i=function(){function t(t,i,r,u,f){typeof f=="undefined"&&(f=n.Vector2d.Zero()),this._imageSource=t,this._frameSize=r,this._frameCount=u,this._startOffset=f,this._playing=!1,this._repeating=!1,this._currentFrame=0,this._framesPerRow=Math.min(Math.floor((t.ClipSize.Width-f.X)/r.Width),u),this._lastStepAt=0,this.OnComplete=new n.EventHandler,this.Fps(i)}return t.prototype.IsPlaying=function(){return this._playing},t.prototype.Play=function(n){typeof n=="undefined"&&(n=!1),this._lastStepAt=(new Date).getTime(),this._repeating=n,this._playing=!0,this.UpdateImageSource()},t.prototype.Pause=function(){this._playing=!1},t.prototype.Step=function(n){typeof n=="undefined"&&(n=1),this._currentFrame+=n,this._currentFrame>=this._frameCount&&(this._repeating?this._currentFrame%=this._frameCount:(this._currentFrame=this._frameCount-1,this.OnComplete.Trigger(),this.Stop(!1))),n!==0&&this.UpdateImageSource()},t.prototype.Stop=function(n){typeof n=="undefined"&&(n=!0),this._playing=!1,n&&this.Reset()},t.prototype.Reset=function(){this._currentFrame=0,this.UpdateImageSource()},t.prototype.Fps=function(n){return typeof n!="undefined"&&(this._fps=n,this._stepEvery=1e3/this._fps),this._fps},t.prototype.Update=function(n){var i=n.Now.getTime()-this._lastStepAt,t=0;this._playing&&(t=Math.floor(i/this._stepEvery),t!==0&&(this._lastStepAt=n.Now.getTime(),this.Step(t)))},t.prototype.UpdateImageSource=function(){var n=this.GetFrameRow(),t=this.GetFrameColumn();this._imageSource.ClipLocation.X=this._startOffset.X+t*this._frameSize.Width,this._imageSource.ClipLocation.Y=this._startOffset.Y+n*this._frameSize.Height,this._imageSource.ClipSize=this._frameSize},t.prototype.GetFrameRow=function(){return Math.floor(this._currentFrame/this._framesPerRow)},t.prototype.GetFrameColumn=function(){return Math.ceil(this._currentFrame%this._framesPerRow)},t}();t.SpriteAnimation=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics})(EndGate||(EndGate={}))